var scene,camera,renderer,raycaster,light,car2,Mining,factory,House,Niagrafalls,ship,treo,dirLight,INTERSECTED,tween,object,dae,car,material,timer,group,cloud,sprite,sprite2,mouse=new THREE.Vector2,slider=document.getElementById("slider"),textureLoader=new THREE.TextureLoader,cameraSpeed=.1;const init=e=>{Detector.webgl||Detector.addGetWebGLMessage(),(scene=new THREE.Scene).fog=new THREE.Fog(5459791,.09,20),camera=new THREE.PerspectiveCamera(90,window.innerWidth/window.innerHeight,.1,1e3),(renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0})).setSize(window.innerWidth,window.innerHeight),renderer.setClearColor(16777215,0),renderer.shadowMap.enabled=!0,renderer.shadowMap.type=THREE.PCFSoftShadowMap,document.body.appendChild(renderer.domElement),light=new THREE.AmbientLight(16777215,.1),dirLight=new THREE.DirectionalLight(16777215,1),scene.add(dirLight),scene.add(light),group=new THREE.Group,cloud=textureLoader.load("cloud.png"),material=new THREE.SpriteMaterial({map:cloud,color:16777215,fog:!0}),scene.add(group);var t=new THREE.ColladaLoader;t.options.convertUpAxis=!0,t.load("assets/Canada.dae",t=>{(dae=t.scene).traverse(function(e){e instanceof THREE.Mesh&&(e.castShadow=!0,e.receiveShadow=!0)}),dae.scale.x=dae.scale.y=dae.scale.z=1,dae.updateMatrix(),scene.add(dae);new THREE.BoxGeometry(5e3,600,5e3),new THREE.MeshBasicMaterial({color:3422514,transparent:!0});car=dae.getObjectByName("Honda",!0),car2=dae.getObjectByName("Toyota",!0),Mining=dae.getObjectByName("Mining",!0),factory=dae.getObjectByName("factory",!0),House=dae.getObjectByName("House",!0),Niagrafalls=dae.getObjectByName("Niagrafalls",!0),ship=dae.getObjectByName("ship",!0),treo=dae.getObjectByName("treo",!0),e("resolved"),render(),timer=setInterval(makeSmoke,2500)}),camera.position.set(8,2,4),camera.rotation.y=.8,raycaster=new THREE.Raycaster,document.addEventListener("mousemove",onDocumentMouseMove,!1)};window.addEventListener("resize",()=>{camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)});const onDocumentMouseMove=e=>{mouse.x=e.clientX/window.innerWidth*2-1,mouse.y=-e.clientY/window.innerHeight*2+1};function makeSmoke(){var e=car.position.clone(),t=car2.position.clone(),a=Mining.position.clone(),i=factory.position.clone(),r=House.position.clone(),s=Niagrafalls.position.clone(),n=ship.position.clone(),o=treo.position.clone();sprite=new THREE.Sprite(material),sprite2=new THREE.Sprite(material),sprite3=new THREE.Sprite(material),sprite4=new THREE.Sprite(material),sprite5=new THREE.Sprite(material),sprite6=new THREE.Sprite(material),sprite7=new THREE.Sprite(material),sprite8=new THREE.Sprite(material),sprite.position.set(e.x,e.y,e.z),sprite2.position.set(t.x,t.y,t.z),sprite3.position.set(a.x,a.y,a.z),sprite4.position.set(i.x,i.y,i.z),sprite5.position.set(r.x,r.y,r.z),sprite6.position.set(s.x,s.y,s.z),sprite7.position.set(n.x,n.y,n.z),sprite8.position.set(o.x,o.y,o.z),sprite.scale.x=sprite.scale.y=sprite.scale.z=.1,sprite2.scale.x=sprite2.scale.y=sprite2.scale.z=.1,sprite3.scale.x=sprite3.scale.y=sprite3.scale.z=.1,sprite4.scale.x=sprite4.scale.y=sprite4.scale.z=.1,sprite5.scale.x=sprite5.scale.y=sprite5.scale.z=.1,sprite6.scale.x=sprite6.scale.y=sprite6.scale.z=.1,sprite7.scale.x=sprite7.scale.y=sprite7.scale.z=.1,sprite8.scale.x=sprite8.scale.y=sprite8.scale.z=.1,group.add(sprite),group.add(sprite2),group.add(sprite3),group.add(sprite4),group.add(sprite5),group.add(sprite6),group.add(sprite7),group.add(sprite8)}document.onmousedown=(e=>{raycaster.setFromCamera(mouse,camera);var t=raycaster.intersectObjects(scene.children,!0);t.length>0&&"tree"==(INTERSECTED=t[0].object).parent.name&&(INTERSECTED.position.y+=10)});const render=()=>{dirLight.position.set(camera.position.x,camera.position.y,camera.position.z),TWEEN.update(),requestAnimationFrame(render);Date.now();renderer.render(scene,camera);for(let t=0;t<group.children.length;t++){var e=group.children[t];e.position.y<30&&(e.position.y+=.01,e.scale.x=e.scale.y=e.scale.z+=.002)}},changeCamera=()=>{let e=new TWEEN.Tween(camera.position).to({x:6,y:3,z:4},4e3).easing(TWEEN.Easing.Quadratic.InOut),t=new TWEEN.Tween(camera.position).to({x:8,y:.9,z:2},4e3).easing(TWEEN.Easing.Quadratic.InOut),a=new TWEEN.Tween(camera.position).to({x:.9,y:4,z:2},4e3).easing(TWEEN.Easing.Quadratic.InOut),i=new TWEEN.Tween(camera.position).to({x:8,y:4,z:-7},4e3).easing(TWEEN.Easing.Quadratic.InOut),r=new TWEEN.Tween(camera.position).to({x:-3,y:1,z:2},4e3).easing(TWEEN.Easing.Quadratic.InOut),s=new TWEEN.Tween(camera.position).to({x:45,y:6,z:7},4e3).easing(TWEEN.Easing.Quadratic.InOut),n=new TWEEN.Tween(camera.position).to({x:28,y:4,z:20},4e3).easing(TWEEN.Easing.Quadratic.InOut),o=new TWEEN.Tween(camera.position).to({x:28,y:400,z:20},4e3).easing(TWEEN.Easing.Quadratic.InOut),c=new TWEEN.Tween(camera.rotation).to({y:-1},4e3).easing(TWEEN.Easing.Quadratic.InOut);new TWEEN.Tween(camera.rotation).to({z:1},4e3).easing(TWEEN.Easing.Quadratic.InOut),new TWEEN.Tween(camera.rotation).to({y:.6},4e3).easing(TWEEN.Easing.Quadratic.InOut),new TWEEN.Tween(camera.rotation).to({y:-25},4e3).easing(TWEEN.Easing.Quadratic.InOut),new TWEEN.Tween(camera.rotation).to({y:60},4e3).easing(TWEEN.Easing.Quadratic.InOut);1==slider.value?(e.start(),switchTo("texts","text1")):2==slider.value?(t.start(),c.start(),switchTo("texts","text2")):3==slider.value?(a.start(),switchTo("texts","text3")):4==slider.value?(i.start(),switchTo("texts","text4")):5==slider.value?(r.start(),switchTo("texts","text5")):6==slider.value?(s.start(),switchTo("texts","text6")):7==slider.value?(n.start(),switchTo("texts","text7")):8==slider.value&&(o.start(),switchTo("texts","text8"))},switchTo=(e,t)=>{let a=document.getElementsByClassName(e);for(let e=0;e<a.length;e++)a[e].style.display="none";let i=document.getElementsByClassName(t)[0];i.style.display="block",i.style.opacity=0,i.style.transition="opacity 10s ease-out",setTimeout(()=>{i.style.opacity=1},100)};function initThreeJs(){return new Promise(e=>{init(e)})}async function deleteLoading(){await initThreeJs();document.getElementsByClassName("preload")[0].style.display="none"}deleteLoading();
